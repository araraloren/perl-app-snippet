#!/usr/bin/env perl6

use Pluggable;
use Getopt::Advance;
use App::snippet;

my (@compilers, @interfaces);

for plugins("App::snippet", :plugins-namespace<Compiler>) -> $plugin {
    @compilers.push($plugin.new());
}

for plugins("App::snippet", :plugins-namespace<Interface>) -> $plugin {
    @interfaces.push($plugin.new(
        compilers => @compilers.grep( { $plugin.lang (elem) .supports()>>.lang }),
        lang => $plugin.lang,
    ));
}

getopt(|(@interfaces>>.optionset), :autohv);
